#include "iLocalizer.h"

using namespace Robotics;
using namespace Robotics::GameTheory;
using namespace std;


	////////////////////////////////////////////////////
	geometry_msgs::Point iLocalizer::getPosition()
	{
	  Lock lock(m_mutex);
	  return m_config.getPosition();
	}
	
	////////////////////////////////////////////////////
	geometry_msgs::Quaternion iLocalizer::getOrientation()
	{
	  Lock lock(m_mutex);
	  return m_config.getOrientation();
	}
	
	////////////////////////////////////////////////////
	Configuration iLocalizer::getConfiguration()
	{
		Lock lock(m_mutex);
		return m_config;
	}
	
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////

	////////////////////////////////////////////////////
	SimulatorLocalizer(std::string name_) 
	: iLocalizer(name_) 
	{
	   std::string l_agentname = "SimulatorLocalizer_";
	   l_agentname+=name_;
    	  
	   m_sub = m_node.subscribe(l_agentname.c_str(), 10, &SimulatorLocalizer::update, this);
	}
	
	////////////////////////////////////////////////////
	void SimulatorLocalizer::update(geometry_msgs::PoseConstPtr & pose_)
	{
	  Lock l_lock(m_mutex);
	  
	  // TODO: chiede al simulotre la configurazione del robot
	}
	
	////////////////////////////////////////////////////
	void SimulatorLocalizer::updatePosition()
	{
	  // TODO: chiede al simulotre la posizione del robot
	}
	
	////////////////////////////////////////////////////
	void SimulatorLocalizer::updateOrientation()
	{
	  // TODO: chiede al simulotre l'orientazione del robot
	}
							

	////////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////

	////////////////////////////////////////////////////
	KinectLocalizer(std::string name_, ColorName back_, ColorName front_) 
	: iLocalizer(name_)
	, m_back(back_)
	, m_front(front_) 
	{
	  std::string l_agentname = "KinectLocalizer_";
	  l_agentname+=name_;
	  
	  m_sub = m_node.subscribe(l_agentname.c_str(), 10, &KinectLocalizer::update, this);
	}
	
	////////////////////////////////////////////////////
	void KinectLocalizer::update(geometry_msgs::PoseConstPtr & pose_)
	{
	  Lock l_lock(m_mutex);
	  
	  // TODO: chiede al kinect la configurazione del robot
	}
	
	////////////////////////////////////////////////////
	void KinectLocalizer::updatePosition()
	{
	  // TODO: chiede al kinect la posizione del robot
	}
	
	////////////////////////////////////////////////////
	void KinectLocalizer::updateOrientation()
	{
	  // TODO: chiede al kinect l'orientazione del robot
	}

	
